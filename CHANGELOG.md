# 更新日志

所有重要的项目更新都会记录在此文件中。

## [1.9.0] - 2024-12-05

### 新增
- **恐惧贪婪指数 (Fear & Greed Index)**
  - `fear_greed.py` - 恐惧贪婪指数模块
  - 接入 alternative.me Fear & Greed Index API
  - 指数范围 0-100：极度恐惧/恐惧/中性/贪婪/极度贪婪
  - 情绪分析与交易信号建议
  - 辅助判断市场顶底区域

- **前端可视化展示**
  - SVG 环形仪表盘显示指数值
  - 渐变进度条直观展示位置
  - 情绪描述 + 交易信号建议

- **新增 API**
  - `/api/fear-greed` - 获取恐惧贪婪指数

---

## [1.8.1] - 2024-12-05

### 改进
- **周期选择持久化**
  - 用户选择的交易建议周期自动保存到 localStorage
  - 页面刷新或自动数据更新后保持用户之前的选择
  - 每个交易对的周期选择独立保存，互不影响
  - 解决了刷新页面后周期重置为 1h 的体验问题

---

## [1.8.0] - 2024-12-04

### 新增
- **预测准确率统计系统**
  - `prediction_tracker.py` - 预测记录追踪模块
  - 自动记录每次预测（方向、置信度、价格、时间）
  - 按周期自动验证历史预测（5m/30m/1h/4h/1d）
  - 统计总体准确率、按周期/置信度分类准确率
  - 预测数据保存到本地 JSON 文件，保留 7 天

- **前端准确率展示**
  - 页面顶部新增准确率统计卡片
  - 总体准确率醒目显示
  - 按周期/置信度分组展示
  - 已验证/待验证数量统计

- **新增 API**
  - `/api/accuracy` - 获取预测准确率统计数据

---

## [1.7.0] - 2024-12-04

### 新增
- **多周期交易建议切换**
  - 交易建议区域新增周期 Tab（5m/30m/1h/4h/1d）
  - 支持点击切换查看不同周期的交易建议
  - 默认显示 1h 周期（保持原有行为）
  - 各交易对独立切换，互不影响
  - 无数据的周期 Tab 自动置灰禁用

### 改进
- 交易建议 UI 优化，Tab 切换流畅

---

## [1.6.0] - 2024-12-04

### 性能优化
- **并行数据获取** - 使用 ThreadPoolExecutor 10线程并行请求
- **内存缓存机制** - 20秒有效期缓存，避免重复计算
- **后台预加载** - 每30秒自动更新数据，前端秒级响应
- **数据量优化** - K线从1000根降到300根，减少70%传输量

### 性能提升
| 指标 | 优化前 | 优化后 | 提升 |
|------|--------|--------|------|
| API响应时间 | 10-15秒 | 0.02秒 | **500倍** |

### 新增
- `data_cache.py` - 数据缓存管理模块
- `/api/cache-stats` - 缓存状态查询接口

---

## [1.5.0] - 2024-12-04

### 新增
- **交易建议系统**
  - 自动生成做多/做空/观望建议
  - 基于 ADX 趋势强度 + 多指标共振判断
  - 置信度分级（极高/高/中高/中/低）

- **止盈止损计算**
  - 基于 ATR 动态计算止损位
  - 结合支撑阻力位优化止损点
  - 三级止盈位（TP1: 1.5R, TP2: 2.5R, TP3: 4R）
  - 分批止盈建议（30%/40%/30%）

- **合约杠杆建议**
  - 综合波动率、置信度、趋势强度计算
  - 安全杠杆 + 最大杠杆双档建议
  - 自动根据市况调整（高波动降杠杆）

- **K线形态悬浮提示**
  - 18种形态详细说明
  - 形态定义 + 操作建议
  - 鼠标悬停显示提示卡片

### 前端优化
- 新增交易建议卡片展示
- 杠杆建议可视化（⚡ 图标）
- 风险等级标签（低/中/高）

---

## [1.4.0] - 2024-12-03

### 新增
- **机器学习预测模块** (`ml_predictor.py`)
  - XGBoost 分类模型
    - 三分类预测（上涨/横盘/下跌）
    - 自动特征工程（30+ 特征）
    - 模型保存/加载支持
    - 特征重要性分析
  - LSTM 深度学习模型（可选）
    - 序列化时间窗口输入
    - 双层 LSTM + Dropout 架构
    - 早停机制防止过拟合
  - 统一预测接口 `MLPredictor`

- **特征工程**
  - 价格变化特征（1/2/5/10 周期）
  - 波动率特征（5/10/20 周期）
  - 技术指标特征（RSI/MACD/ADX/布林带等）
  - MA/EMA 相对位置特征
  - K线形态特征
  - 动量和 OBV 特征

### 依赖
- 新增 `xgboost>=2.0.0`
- 新增 `tensorflow>=2.15.0`（可选，用于 LSTM）
- 需要安装 `libomp`（Mac: `brew install libomp`）

---

## [1.3.0] - 2024-12-03

### 新增
- **K线形态识别** - 支持15种常见K线形态自动识别
  - 反转形态：锤子线、倒锤子线、上吊线、射击之星
  - 十字星系列：长腿十字星、蜻蜓十字星、墓碑十字星
  - 吞没形态：看涨吞没、看跌吞没
  - 其他反转：乌云盖顶、刺透形态
  - 三线形态：早晨之星、黄昏之星、三只白兵、三只黑鸦
  - 持续形态：大阳线、大阴线

- **支撑阻力位识别**
  - 自动识别局部高低点
  - 聚类相近价位，避免重复
  - 计算最近支撑/阻力位
  - 实时显示距离支撑/阻力的百分比

- **K线图表页面** (`/chart`)
  - 基于 TradingView Lightweight Charts
  - 支持交易对和周期切换
  - MA均线显示/隐藏切换 (MA7/MA25/MA99)
  - 布林带显示/隐藏切换
  - 成交量柱状图
  - K线形态标记（箭头标注）
  - 支撑阻力线可视化
  - 右侧信息面板显示形态和关键价位

### 改进
- 首页添加"K线图表"快捷入口
- API新增 `/api/klines` 接口，返回完整K线和指标数据

---

## [1.2.0] - 2024-12-03

### 新增
- **回测系统** (`backtest.py`)
  - 使用历史数据验证预测策略
  - 统计预测准确率和交易胜率
  - 按置信度分组分析准确率
  - 计算累计收益和平均单次收益
  - 支持完整回测报告输出
  - 初步测试 BTCUSDT 1h 准确率达 70.7%

### 依赖
- 新增 `tabulate` 库用于格式化回测报告

---

## [1.1.0] - 2024-12-03

### 新增
- **ADX 趋势强度指标**
  - 计算 +DI/-DI 判断多空方向
  - ADX 值判断趋势强度（极强/强/形成/震荡）
  - 趋势强度影响置信度评级

- **Stochastic RSI 指标**
  - 比传统RSI更敏感的超买超卖信号
  - 支持金叉/死叉信号识别
  - 超买回落/超卖反弹信号

- **OBV 能量潮指标**
  - 量价关系分析
  - 顶背离/底背离识别
  - 量能积累/衰减判断

- **动量指标**
  - Momentum 动量值
  - ROC 变化率
  - 加速/减速上涨/下跌判断

- **EMA 趋势指标**
  - EMA12/EMA26/EMA50
  - EMA 多头/空头排列识别

### 改进
- **指标权重分级优化**
  - ADX趋势强度 (2.0) - 最高权重
  - MA排列 (1.8)
  - MACD (1.5)
  - EMA趋势 (1.3)
  - 动量 (1.2)
  - RSI/OBV (1.0)
  - 布林带 (0.8)

- **评分算法优化**
  - ADX 调整置信度，震荡行情自动降级
  - 加权线性回归，最近数据权重更高
  - 新增趋势确认分析（连续K线同向性）

- **5m 周期权重配置**
  - 5m: 0.5, 30m: 1.0, 1h: 1.5, 4h: 2.0, 1d: 3.0

---

## [1.0.1] - 2024-12-03

### 修复
- 修复卡片显示顺序问题，现在按时间周期排序（5m → 30m → 1h → 4h → 1d）
- 添加 `intervalToMinutes` 和 `sortIntervals` 前端排序函数

---

## [1.0.0] - 2024-12-03

### 新增
- **5分钟周期支持**
  - 新增 5m K线周期
  - 调整前端网格布局适配5个周期
  - 添加中等屏幕响应式布局优化

### 修复
- 修复原 10m 周期配置（币安API不支持10m，改为5m）

---

## [0.1.0] - 2024-12-03

### 初始版本
- **多周期分析**: 30分钟、1小时、4小时、日线
- **技术指标**: MA(7/25/99)、RSI、MACD、布林带、ATR
- **成交量加权评分**: 放量信号权重提升，缩量信号权重降低
- **多周期共振分析**: 判断各周期方向一致性
- **Flask Web界面**: 实时刷新的可视化面板
- **命令行模式**: 终端输出详细分析报告

---

## 版本号说明

- **主版本号**: 重大功能更新或架构变更
- **次版本号**: 新功能添加
- **修订号**: Bug修复和小改进
